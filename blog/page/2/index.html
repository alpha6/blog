<!DOCTYPE html>
<html>
    <head>
	<meta charset="UTF-8">
        <link href="/theme/css/normalize.css" rel="stylesheet">
        <link href="/theme/css/skeleton.css" rel="stylesheet">
        <link href="/theme/css/statocles-default.css" rel="stylesheet">
        <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
        <title>Just another blog</title>
        <meta content="Statocles 0.061" name="generator">
        <link href="/blog/index.atom" rel="alternate" type="application/atom+xml">
        <link href="/blog/index.rss" rel="alternate" type="application/rss+xml">
        
    </head>
    <body>
        <header>
            <nav class="navbar">
                <div class="container">
                    <a class="brand" href="/">Just another blog</a>
                    <ul>
                        <li>
                            <a href="/">Blog</a>
                        </li>
                    </ul>
                    
                </div>
            </nav>
            
        </header>
        <div class="main container">
            
<div class="row">

    <div class="nine columns">
        <main>


            <article>
                <header>
                    <h1><a href="/blog/2015/09/29/prostgresql-interval-in-future/">prostgresql interval in future</a></h1>

                    <p class="tags">Tags:
                        <a href="/blog/tag/Postgresql/" rel="tag">Postgresql</a>
                        <a href="/blog/tag/data/" rel="tag">data</a>
                        <a href="/blog/tag/timestamp/" rel="tag">timestamp</a>
                    </p>

                    <aside>
                        <p><time datetime="2015-09-29">
                            Posted on 2015-09-29
                        </time>
                        <a data-disqus-identifier="/2015/09/29/prostgresql-interval-in-future/index.markdown" href="/blog/2015/09/29/prostgresql-interval-in-future/#disqus_thread">0 comments</a>
                        </p>
                    </aside>

                </header>

                <p>Чтобы получить значение времени в заданном интервале от текущего момента можно использовать следующий синтаксис:</p>

<pre><code>SELECT NOW() + &#39;5 minutes&#39;::interval;
SELECT NOW() + &#39;5 days&#39;::interval;
</code></pre>

<p>Работает и в плюс и в минус.</p>



            </article>
            <article>
                <header>
                    <h1><a href="/blog/2015/09/19/dbd-pg-install/">DBD::Pg install</a></h1>

                    <p class="tags">Tags:
                        <a href="/blog/tag/Ubuntu/" rel="tag">Ubuntu</a>
                        <a href="/blog/tag/Postgresql/" rel="tag">Postgresql</a>
                        <a href="/blog/tag/Perl/" rel="tag">Perl</a>
                        <a href="/blog/tag/DBD::Pg/" rel="tag">DBD::Pg</a>
                    </p>

                    <aside>
                        <p><time datetime="2015-09-19">
                            Posted on 2015-09-19
                        </time>
                        <a data-disqus-identifier="/2015/09/19/dbd-pg-install/index.markdown" href="/blog/2015/09/19/dbd-pg-install/#disqus_thread">0 comments</a>
                        </p>
                    </aside>

                </header>

                <p>Markdown content goes here.</p>

<p>Если при установке <code>DBD::Pg</code> через <code>CPAN</code> у вас начинают спрашивать какие-то странные слова про номер версии и расположение директорий Postgresql - проверьте что у вас установлен пакет <code>postgresql-server-dev-X.X</code> (<code>postgresql-server-dev-all</code>).</p>

<p>После его установки проблема магическим (на самом деле нет) образом исчезает.</p>



            </article>
            <article>
                <header>
                    <h1><a href="/blog/2015/09/14/get-package-methods/">Получение методов пакета</a></h1>

                    <p class="tags">Tags:
                        <a href="/blog/tag/perl/" rel="tag">perl</a>
                        <a href="/blog/tag/note/" rel="tag">note</a>
                        <a href="/blog/tag/package/" rel="tag">package</a>
                    </p>

                    <aside>
                        <p><time datetime="2015-09-14">
                            Posted on 2015-09-14
                        </time>
                        <a data-disqus-identifier="/2015/09/14/get-package-methods/index.markdown" href="/blog/2015/09/14/get-package-methods/#disqus_thread">0 comments</a>
                        </p>
                    </aside>

                </header>

                <p>Для получения методов пакета Foo::Bar делаем:</p>

<pre><code>print Dumper(\%Foo::Bar::);
</code></pre>

<p>Для проверки существования метода:</p>

<pre><code>if (Foo::Bar::.$method_name) {
    #some stuff
}
</code></pre>

<p>Для получения методов текущего пакета:</p>

<pre><code>print Dumper(\%main::)
</code></pre>

<p>Но если подключены дополнительные библиотеки - в выводе будут методы всех подключенных библиотек.</p>

<p><a href="http://perldoc.perl.org/perlmod.html#Symbol-Tables">Подробнее в документации</a></p>



            </article>
            <article>
                <header>
                    <h1><a href="/blog/2015/05/24/ubuntu-bcm43142/">ubuntu 15.04 и BCM43142</a></h1>

                    <p class="tags">Tags:
                        <a href="/blog/tag/Ubuntu/" rel="tag">Ubuntu</a>
                        <a href="/blog/tag/note/" rel="tag">note</a>
                    </p>

                    <aside>
                        <p><time datetime="2015-05-24">
                            Posted on 2015-05-24
                        </time>
                        <a data-disqus-identifier="/2015/05/24/ubuntu-bcm43142/index.markdown" href="/blog/2015/05/24/ubuntu-bcm43142/#disqus_thread">0 comments</a>
                        </p>
                    </aside>

                </header>

                <p>После апгрейда Ubuntu 14.04 на Kubuntu 15.04 выяснилось что Wi-Fi на моем ноутбуке работать не хочет от слова &quot;совсем&quot;. И если в 14.04 после подключения к интернету он сам предлагал доустановить нужные драйвера - то в 15.04 магия не срабатывала и Wi-Fi не работал.</p>

<p>Симптомы:
* в NetworkManager нет даже пункта про беспроводные подключения.
* <code># lshw -c Network</code> говорит что-то вроде:</p>

<pre><code>*-network UNCLAIMED     
   description: Network controller
   product: BCM43142 802.11b/g/n
   vendor: Broadcom Corporation
   physical id: 0
   bus info: pci@0000:02:00.0
   version: 01
   width: 64 bits
   clock: 33MHz
   capabilities: bus_master cap_list
   configuration: latency=0
   resources: memory:90500000-90507fff
</code></pre>

<p>Как можно заметить - устройство карте не назначено. Значит надо доустановить пакет с прошивкой для карты. С 14.04 эта карта поддерживается в официальных драйверах, так что просто устанавливаем пакет руками:</p>

<pre><code>sudo apt-get install bcmwl-kernel-source
</code></pre>

<p>Перезагружемся и видим в NetworkManager раздел с беспроводными сетями.</p>



            </article>
            <article>
                <header>
                    <h1><a href="/blog/2015/05/20/airport-linux/">Превращаем Linux компьютер в AirPlay приемник</a></h1>

                    <p class="tags">Tags:
                        <a href="/blog/tag/airplay/" rel="tag">airplay</a>
                        <a href="/blog/tag/linux/" rel="tag">linux</a>
                        <a href="/blog/tag/shairport/" rel="tag">shairport</a>
                    </p>

                    <aside>
                        <p><time datetime="2015-05-20">
                            Posted on 2015-05-20
                        </time>
                        <a data-disqus-identifier="/2015/05/20/airport-linux/index.markdown" href="/blog/2015/05/20/airport-linux/#disqus_thread">0 comments</a>
                        </p>
                    </aside>

                </header>

                <p>Захотелось мне как-то играть музыку с мака на колонки без проводов. Раньше для этого я пользовался AirPort Express, када были воткнуты колонки. Но сия халява кончилась и теперь надо что-то изобретать.</p>

<p>Быстрый поиск по интернетам показал существование демона shairport, который предствляет собой AirPlay приемник для Linux. Проблема в том, что данный демон уже давно не поддерживается и автор прямо отказался от его поддержки. Но благодаря великой силе форков гитхаба был найден проект <a href="https://github.com/mikebrady/shairport-sync">shairport-sync</a>, который является форком shairport с допилами и поддерживается в настоящее время. То что надо!</p>

<p>Итак, краткий мануал по установке. Я взял старый asus eee 900, на котором стоит xubuntu 14.04LTS. По совместительству он работает у меня домашним сервером.</p>

<ul>
<li>Клонируем к себе репозиторий <code>git clone https://github.com/mikebrady/shairport-sync.git</code></li>
<li>Устанавливаем зависимости нужное для сборки <code>apt install build-essential autoconf checkinstall libtool libdaemon-dev libasound2-dev libpopt-dev</code></li>
<li>Устанавливаем Avahi <code>apt install avahi-daemon libavahi-client-dev</code></li>
<li>Устанавливаем зависимости для работы с SSL <code>apt install libssl-dev</code>. Демон умеет работать с OpenSSL или PolarSSL, но этот пакет нужен для обеих библиотек.</li>
<li>Я использовал PolarSSL для сборки, но, в целом, никакой разницы нет. Устанавливаем PolarSSL <code>apt install libpolarssl-dev</code></li>
<li>Запускаем autoconf <code>autoreconf -i -f</code> после этого будет сгенерирован файл configure.</li>
<li><code>$ ./configure --with-alsa --with-avahi --with-ssl=polarssl</code></li>
<li><code>make</code></li>
<li><code>sudo checkinstall</code>. Checkinstall задаст несколько вопросов, на них можно ответить по умолчанию, единственное что надо задать поле <code>version</code> в виде числа. Т.к. по умолчанию туда попадает значение <code>sync</code> и checkinstall падает с ошибкой создания пакета.</li>
</ul>

<p>Почему вместо <code>make install</code> лучше использовать <code>checkinstall</code>? Эта утилита перехватит работу make, отследит куда ставятся все файлы приложения и создаст deb пакет для безопасной установки и удаления приложения.</p>

<p>Конфигурируется демон через редактирования файла <code>/etc/init.d/shairport-sync</code>, я там поменял только название сервиса. Обычно больше ничего не требуется для работы.</p>

<h3>Возможные проблемы</h3>

<p>При загрузке компьютера может появляться сообщение:</p>

<pre><code>Avahi detected that your currently configured local DNS server serves a domain .local. This is inherently incompatible with Avahi and thus Avahi disabled itself. If you want to use Avahi in this network, please contact your administrator and convince him to use a different DNS domain, since .local should be used exclusively for Zeroconf technology.
</code></pre>

<p>Работа Avahi будет останавливаться, соответственно и shairport не запустится. Обычно эта проблема связана с тем, что в DNS сервере есть записи для зоны local.</p>

<p>Проверяется это командой: <code>host -t SOA local.</code> (обратите внимание на точку в конце!). В нормальной ситуации вывод должен быть около такого: </p>

<pre><code>bash-3.2$ host -t SOA local.
Host local. not found: 3(NXDOMAIN)
</code></pre>

<p>Если же в выводе написано: <code>local has SOA record XXX</code>, то ваш DNS транслирует зону local. Обычно это делают провайдеры для работы сервисов типа retracker.local. Если вы этим не пользуетесь - можно просто указать днс Yandex (77.88.8.8/77.88.8.1) или Google(8.8.8.8/8.8.4.4).</p>

<p>После этих настроек и рестарта служб - все должно работать, а на устройствах Apple появится ваше устройство для вывода звука.</p>



            </article>
        </main>

        <ul class="pager">
            <li class="prev">
                <a class="button button-primary" href="/blog/page/3" rel="next">
                    ← Older
                </a>
            </li>
            <li class="next">
                <a class="button button-primary" href="/" rel="prev">
                    Newer →
                </a>
            </li>
        </ul>

    </div>

    <div class="three columns sidebar">
        
        <h1>Tags</h1>
        <ul class="list-inline">
            <li><a href="/blog/tag/Automation/">Automation</a></li>
            <li><a href="/blog/tag/DBD::Pg/">DBD::Pg</a></li>
            <li><a href="/blog/tag/ElCapitan/">ElCapitan</a></li>
            <li><a href="/blog/tag/LC_ALL/">LC_ALL</a></li>
            <li><a href="/blog/tag/MacOS/">MacOS</a></li>
            <li><a href="/blog/tag/Perl/">Perl</a></li>
            <li><a href="/blog/tag/Postgresql/">Postgresql</a></li>
            <li><a href="/blog/tag/Redmine/">Redmine</a></li>
            <li><a href="/blog/tag/Rex/">Rex</a></li>
            <li><a href="/blog/tag/Spotlight/">Spotlight</a></li>
            <li><a href="/blog/tag/Ubuntu/">Ubuntu</a></li>
            <li><a href="/blog/tag/airplay/">airplay</a></li>
            <li><a href="/blog/tag/bugs/">bugs</a></li>
            <li><a href="/blog/tag/data/">data</a></li>
            <li><a href="/blog/tag/debian/">debian</a></li>
            <li><a href="/blog/tag/elasticsearch/">elasticsearch</a></li>
            <li><a href="/blog/tag/gearman/">gearman</a></li>
            <li><a href="/blog/tag/git/">git</a></li>
            <li><a href="/blog/tag/graylog/">graylog</a></li>
            <li><a href="/blog/tag/graylog2/">graylog2</a></li>
            <li><a href="/blog/tag/io/">io</a></li>
            <li><a href="/blog/tag/linux/">linux</a></li>
            <li><a href="/blog/tag/nginx/">nginx</a></li>
            <li><a href="/blog/tag/note/">note</a></li>
            <li><a href="/blog/tag/package/">package</a></li>
            <li><a href="/blog/tag/perl/">perl</a></li>
            <li><a href="/blog/tag/postgresql/">postgresql</a></li>
            <li><a href="/blog/tag/shairport/">shairport</a></li>
            <li><a href="/blog/tag/snippet/">snippet</a></li>
            <li><a href="/blog/tag/state/">state</a></li>
            <li><a href="/blog/tag/timestamp/">timestamp</a></li>
            <li><a href="/blog/tag/trap/">trap</a></li>
            <li><a href="/blog/tag/ubuntu/">ubuntu</a></li>
            <li><a href="/blog/tag/windows/">windows</a></li>
        </ul>
        <h1>Feeds</h1>
        <ul class="list-inline">
            <li>
                <a href="/blog/index.atom" rel="alternate" type="application/atom+xml">
                    Atom
                </a>
            </li>
            <li>
                <a href="/blog/index.rss" rel="alternate" type="application/rss+xml">
                    RSS
                </a>
            </li>
        </ul>
    </div>

</div>

<script type="text/javascript">
    var disqus_shortname = 'alpha6sblog';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>

            <div id="disqus_thread"></div>
            <script>
            /**
            * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
            * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
            */
            /*
            var disqus_config = function () {
            this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
            this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
            };
            */
            (function() { // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');  s.src = '//alpha6sblog.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

        </div>
        <footer>
            
            <div class="container tagline">
                <a href="http://preaction.github.io/Statocles">Made with Statocles</a><br>
                <a href="http://www.perl.org">Powered by Perl</a>
            </div>

            <script async id="dsq-count-scr" src="//alpha6sblog.disqus.com/count.js"></script>
            <!-- Yandex.Metrika counter --><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter7948447 = new Ya.Metrika({ id:7948447, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img alt="" src="https://mc.yandex.ru/watch/7948447" style="position:absolute; left:-9999px;"></div></noscript><!-- /Yandex.Metrika counter -->
            <!-- Google analytics --><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create', 'UA-7392296-3', 'auto');ga('send', 'pageview');</script>
        </footer>
    </body>
</html>
