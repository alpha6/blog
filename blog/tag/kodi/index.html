<!DOCTYPE html>
<html>
    <head>
	<meta charset="UTF-8">
        <link href="/theme/css/normalize.css" rel="stylesheet">
        <link href="/theme/css/skeleton.css" rel="stylesheet">
        <link href="/theme/css/statocles-default.css" rel="stylesheet">
        <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
        <title>Just another blog</title>
        <meta content="Statocles 0.077" name="generator">
        <link href="/blog/tag/kodi.atom" rel="alternate" type="application/atom+xml">
        <link href="/blog/tag/kodi.rss" rel="alternate" type="application/rss+xml">
        
    </head>
    <body>
        <header>
            <nav class="navbar">
                <div class="container">
                    <a class="brand" href="/">Just another blog</a>
                    <ul>
                        <li>
                            <a href="/">Blog</a>
                        </li>
                    </ul>
                    
                </div>
            </nav>
            
        </header>
        <div class="main container">
            
<div class="row">

    <div class="nine columns">
        <main>


            <article>
                <header>
                    <h1><a href="/blog/2016/10/09/orange-pi-armbian-kodi/">How to fix sound issue with KODI on the orange pi</a></h1>

                    <p class="tags">Tags:
                        <a href="/blog/tag/orange-pi/" rel="tag">orange pi</a>
                        <a href="/blog/tag/kodi/" rel="tag">kodi</a>
                        <a href="/blog/tag/armbian/" rel="tag">armbian</a>
                    </p>

                    <aside>
                        <p><time datetime="2016-10-09">
                            Posted on 2016-10-09
                        </time>
                        <a data-disqus-identifier="/2016/10/09/orange-pi-armbian-kodi/index.markdown" href="/blog/2016/10/09/orange-pi-armbian-kodi/#disqus_thread">0 comments</a>
                        </p>
                    </aside>

                </header>

                <p>I have Orange Pi One board. It&#39;s a great product, it is faster, cheaper and smaller then Raspberry Pi, but it uses AllWinner H3 SOC and it is its main disadvantage.</p>

<p>If you want to use this board as a media center with KODI, you face the problem with sound. The sound works in Armbian applications but doesn&#39;t work in KODI. It happens because KODI uses S24_LE sampling format which is not supported by Orange Pi hardware.</p>

<pre><code>root@orangepione:~# speaker-test  -D hw:1 -c2 --format S24_LE

speaker-test 1.0.28

Format S24_LE is not supported...
</code></pre>

<p>Ok, we found out the root of the problem, time to fix it!</p>

<p>Now we need to set sampling format which is supported by Orange Pi hardware. One of supported sample formats is S32_LE.
Check if it is correct:</p>

<pre><code>root@orangepione:~# speaker-test  -D hw:1 -c2 --format S32_LE

speaker-test 1.0.28

Playback device is hw:1
Stream parameters are 48000Hz, S32_LE, 2 channels
Using 16 octaves of pink noise
Rate set to 48000Hz (requested 48000Hz)
Buffer size range from 64 to 131072
Period size range from 32 to 16384
Using max buffer size 131072
Periods = 4
</code></pre>

<p>Now check soundcards, we need to get the device number which plays over HDMI output.</p>

<pre><code>root@orangepione:~# cat /proc/asound/cards
 0 [audiocodec     ]: audiocodec - audiocodec
                      audiocodec
 1 [sndhdmi        ]: sndhdmi - sndhdmi
                      sndhdmi
</code></pre>

<p>The <code>sndhdmi</code> is a soundcard which attracts our interest. Remember the number of this one.</p>

<p>Now we can edit the Alsa config:</p>

<pre><code>vim /etc/asound.conf
</code></pre>

<p>Delete old content and paste the following one:</p>

<pre><code>pcm.snd_card {
        type hw
        card 1
        device 0
}

ctl.snd_card {
        type hw
        card 1
        device 0
}

pcm.dmixer {
    type dmix
    ipc_key 1024
    ipc_perm 0666
    slave.pcm &quot;snd_card&quot;
    slave {
        period_time 0
        period_size 1024
        buffer_size 4096
        rate 48000
        format S32_LE
        channels 2
    }
    bindings {
        0 0
        1 1
    }
}
</code></pre>

<p>Save the file and reboot.</p>

<p>After that the KODI will play sound.
If it doesn&#39;t play, check the number in <code>card</code> fields of the config, it must be the number from <code>sndhdmi</code> card, and samplerate and samplerate format in <code>slave</code> section. The samplerate should be equal with one from the <code>speaker-test</code> command output.</p>



            </article>
        </main>

        <ul class="pager">
            <li class="prev">
                <a class="button disabled" href="" rel="next">
                    ← Older
                </a>
            </li>
            <li class="next">
                <a class="button disabled" href="" rel="prev">
                    Newer →
                </a>
            </li>
        </ul>

    </div>

    <div class="three columns sidebar">
        
        <h1>Tags</h1>
        <ul class="list-inline">
            <li><a href="/blog/tag/3dprinting/">3dprinting</a></li>
            <li><a href="/blog/tag/airplay/">airplay</a></li>
            <li><a href="/blog/tag/armbian/">armbian</a></li>
            <li><a href="/blog/tag/automation/">Automation</a></li>
            <li><a href="/blog/tag/bugs/">bugs</a></li>
            <li><a href="/blog/tag/data/">data</a></li>
            <li><a href="/blog/tag/dbd-pg/">DBD::Pg</a></li>
            <li><a href="/blog/tag/debian/">debian</a></li>
            <li><a href="/blog/tag/diy/">diy</a></li>
            <li><a href="/blog/tag/elasticsearch/">elasticsearch</a></li>
            <li><a href="/blog/tag/elcapitan/">ElCapitan</a></li>
            <li><a href="/blog/tag/email/">email</a></li>
            <li><a href="/blog/tag/gearman/">gearman</a></li>
            <li><a href="/blog/tag/git/">git</a></li>
            <li><a href="/blog/tag/graylog/">graylog</a></li>
            <li><a href="/blog/tag/graylog2/">graylog2</a></li>
            <li><a href="/blog/tag/io/">io</a></li>
            <li><a href="/blog/tag/java/">java</a></li>
            <li><a href="/blog/tag/jcifs/">jcifs</a></li>
            <li><a href="/blog/tag/kodi/">kodi</a></li>
            <li><a href="/blog/tag/lc_all/">LC_ALL</a></li>
            <li><a href="/blog/tag/linux/">linux</a></li>
            <li><a href="/blog/tag/macos/">MacOS</a></li>
            <li><a href="/blog/tag/marlin/">marlin</a></li>
            <li><a href="/blog/tag/net-smtp/">Net::SMTP</a></li>
            <li><a href="/blog/tag/nginx/">nginx</a></li>
            <li><a href="/blog/tag/note/">note</a></li>
            <li><a href="/blog/tag/orange-pi/">orange pi</a></li>
            <li><a href="/blog/tag/orangepi/">orangepi</a></li>
            <li><a href="/blog/tag/package/">package</a></li>
            <li><a href="/blog/tag/perl/">perl</a></li>
            <li><a href="/blog/tag/postgresql/">postgresql</a></li>
            <li><a href="/blog/tag/power/">power</a></li>
            <li><a href="/blog/tag/prusai3/">prusai3</a></li>
            <li><a href="/blog/tag/ramps/">ramps</a></li>
            <li><a href="/blog/tag/redmine/">Redmine</a></li>
            <li><a href="/blog/tag/rex/">Rex</a></li>
            <li><a href="/blog/tag/samba/">samba</a></li>
            <li><a href="/blog/tag/shairport/">shairport</a></li>
            <li><a href="/blog/tag/slic3r/">Slic3r</a></li>
            <li><a href="/blog/tag/snippet/">snippet</a></li>
            <li><a href="/blog/tag/spotlight/">Spotlight</a></li>
            <li><a href="/blog/tag/state/">state</a></li>
            <li><a href="/blog/tag/timestamp/">timestamp</a></li>
            <li><a href="/blog/tag/trap/">trap</a></li>
            <li><a href="/blog/tag/ubuntu/">Ubuntu</a></li>
            <li><a href="/blog/tag/windows/">windows</a></li>
        </ul>
        <h1>Feeds</h1>
        <ul class="list-inline">
            <li>
                <a href="/blog/tag/kodi.atom" rel="alternate" type="application/atom+xml">
                    Atom
                </a>
            </li>
            <li>
                <a href="/blog/tag/kodi.rss" rel="alternate" type="application/rss+xml">
                    RSS
                </a>
            </li>
        </ul>
    </div>

</div>

<script type="text/javascript">
    var disqus_shortname = 'alpha6sblog';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>

            <div id="disqus_thread"></div>
            <script>
            /**
            * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
            * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
            */
            /*
            var disqus_config = function () {
            this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
            this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
            };
            */
            (function() { // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');  s.src = '//alpha6sblog.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

        </div>
        <footer>
            
            <div class="container tagline">
                <a href="http://preaction.github.io/Statocles">Made with Statocles</a><br>
                <a href="http://www.perl.org">Powered by Perl</a>
            </div>

            <script async id="dsq-count-scr" src="//alpha6sblog.disqus.com/count.js"></script>
            <!-- Yandex.Metrika counter --><script type="text/javascript"> (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter7948447 = new Ya.Metrika({ id:7948447, clickmap:true, trackLinks:true, accurateTrackBounce:true }); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = "https://mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img alt="" src="https://mc.yandex.ru/watch/7948447" style="position:absolute; left:-9999px;"></div></noscript><!-- /Yandex.Metrika counter -->
            <!-- Google analytics --><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create', 'UA-7392296-3', 'auto');ga('send', 'pageview');</script>
        </footer>
    </body>
</html>
